{% load static %}
<script src="{% static 'snap/js/jquery-3.2.1.min.js' %}"></script> 
<script src="{% static 'snap/js/jquery-ui-1.12.1.min.js' %}"></script>
<link rel="stylesheet" href="{% static 'snap/js/jquery-ui.css' %}">
 <style type="text/css">
 table tbody tr:hover {
    background-color: orange;
    cursor: pointer;
}
</style>
<script type="text/javascript">
  $( document ).ready(function() {      
    //console.log( "ready!" );
    $("#session").hide();
    function log( message ) {
          $( "<div>" ).text( message ).prependTo( "#log" );
          $( "#log" ).scrollTop( 0 );
        }
    $.getJSON('progs', function(data) {
       console.log(data);       
       $.each(data,function (key,prg){
           console.log('prg:',prg.id,'-',prg.nom,prg.description?':'+prg.description:'');
           $('#selectProgBase').append("<option value='"+prg.id+"'"+
        	   "title='"+prg.description+"'"+
        	   ">"+prg.nom+"</option>");
       }) ;
       
       
    });
    $("#envoiProgBase").button().click(function(e) {
     $.getJSON('progs/'+$("#selectProgBase").val(), function(data) {
         console.log(data);
         $("#session").show();
         $.each(data,function (key,session){
               //console.log('user:',user.id,'-',user.eleve?user.eleve.classe:'prof');
               $('#sessions').append("<option value='"+session.id+"'>"+(new Date(session.evenement.creation)).toUTCString()+"("+session.evenement.user+")"+"</option>");               
           }) ;
         
     })
    
    });
    $("#selectProgBase").change(function() {
    log("change"+$("#selectProgBase").val())}
    );
    $("#envoiSession").button().click(function(e) {
       //console.log("clic"+$("#sessions").val());
       //$.get('open/'+$("#sessions").val()+"/", function(data)
           $.get('spropen/'+$("#sessions").val()+"/listeOpen", function(data){
             //console.log("recept"+data);
             $( "#log" ).html(data);
             $('table tr').click(function(){
                 alert($(this).text());
             });
            });
           $.get('spropen/'+$("#sessions").val()+"/listeActions", function(data) {
            $("#actions").html(data);           
            });
           $.get('tb/'+$("#sessions").val(), function(data) {
               $("#cyto").html(data);
           })
    });
  
 });
  
  

</script>
<h1>Visualisation de l'apparition des boucles</h1>
<h3>SÃ©lection du programme de base</h3>

  <label for="progbase">Choisir un programme de base: </label>
  <select  list="listeProgBases" id="selectProgBase"></select>
  <datalist id="listeProgBases">  
  </datalist>
  <input type="submit" id="envoiProgBase">
  
  <div id="session">
  <label for="session">Choisir une sessions: </label>
  <select  list="listeSessions" id="sessions"></select>
  <datalist id="listeSessions">  
  </datalist>
  <input type="submit" id="envoiSession">
  </div>
<div class="ui-widget" style="margin-top:2em; font-family:Arial">
  Result:
  <div id="log" style="height: 400px; overflow: auto;" class="ui-widget-content"></div>
</div>

<div class="ui-widget" style="margin-top:2em; font-family:Arial">
  Actions:
  <div id="actions" style="height: 200px; overflow: auto;" class="ui-widget-content"></div>
</div>

<div id="cyto"></div>
