<!DOCTYPE html>
<!-- This code is for demonstration purposes only.  You should not hotlink to Github, Rawgit, or files from the Cytoscape.js documentation in your production apps. -->
<html>
<head>
{% load static %}

<style>
body { 
  font: 14px helvetica neue, helvetica, arial, sans-serif;
}

#cy {
 height: 500;
  width: 100%;
  background-color: lightblue;
  left: 0;
  top: 0;
}
nextblock {
fill-color: red
}
</style>
<meta charset=utf-8 />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, minimal-ui">
<title>Compound nodes</title>
<script src="{% static 'snap/js/cytoscape.min.js' %}"></script>
</head>
<body>
<div id="cy"></div>
<!-- Load appplication code at the end to ensure DOM is loaded -->

<script>
var nodes={{nodes|safe}};
var edges={{edges|safe}};
var maxtime={{maxtime}};
var firstime={{firstime}};
//console.log(tags)
var cy = window.cy = cytoscape({
    container: document.getElementById('cy'),

    boxSelectionEnabled: false,
    autounselectify: true,

    style: [
      {
        selector: 'node',
        css: {
            'shape':'roundrectangle',
            'width':'label',
          'content': 'data(valeur)',
          'text-valign': 'center',
          'text-halign': 'center'
        }
      },
      {
        selector: '$node > node',
        css: {
          'padding-top': '10px',
          'padding-left': '10px',
          'padding-bottom': '10px',
          'padding-right': '10px',
          'text-valign': 'top',
          'text-halign': 'center',
          'background-color': '#bbb'
        }
      },
      {
        selector: 'edge',
        css: {
          'target-arrow-shape': 'data(arrow)',
          'line-color':'data(color)',
          'arrow-scale':10,
          
        }
      },
      {
        selector: ':selected',
        css: {
          'background-color': 'black',
          'line-color': 'black',
          'target-arrow-color': 'black',
          'source-arrow-color': 'black'
        }
      }
    ],

    elements: {
      nodes: nodes,
      edges: edges
    },

    layout: {
      name: 'preset',
      //name: 'grid',
      padding: 1,
      parent: function(node) {
	   //if (node.data['parentId']=='244_init') return '244_init';
	   return node.data['parentId'];
      },
      positions: function(node) {
	   //console.log(node.data('time'),{x:node.data('time')/maxtime,y:node.data('y')});
	   //return {x:node.data('x'),y:node.data('y')}
	   if (node.data('time')==0) return {x:50,y:node.data('y')}
	   return {x:200+800*(node.data('time')-firstime)/(maxtime-firstime),y:node.data('y')}
      }
    }
  });
</script>
</body>
</html>